---
title: "Problem Set 7"
author: "Westley Cook"
date: "4/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# standard first load

library(tidyverse)

# for use of skim()

library(skimr)

# loading and naming congress data

nominate <- read_csv("raw-data/HSall_members.csv", col_types = cols())

```

## Question 1: Exploratory Data Analysis

### 1A) Summary Statistics

```{r question_1a, echo=FALSE}

# This r chunk wrangles the data as requested in the assignment prompt, giving a
# new name to the object for easy use in parts b) and c), then prints the
# results of the skim() function to show some summary stats

# I filter first for just the senate and house, using the vertical bar for "or",
# and additionally filter for just the 116th congress. I use case_when to assign
# names to the variable party, and then filter again to drop the resulting NA
# values (for those neither democrat nor republican, the independents). I then
# use percent_rank() to add percentile values based on nominate_dim1,
# multiplying by 100 and rounding to 0 digits to comply with the assignment
# prompt formatting statement (that the median value should be 50)

nominate_116 <- nominate %>% 
  filter(chamber == "Senate" | chamber == "House",
         congress == 116) %>% 
  mutate(party = case_when(party_code == 100 ~ "Democrat",
                           party_code == 200 ~ "Republican"),
         age = 2019 - born) %>% 
  filter(!is.na(party)) %>% 
  mutate(nominate_percentile = round(percent_rank(nominate_dim1) * 100,
                                     digits = 0))

# Having wrangled the data, I select the two variables of interest, pipe it to
# the skim() function, and print the result

nominate_116 %>% 
  select(nominate_percentile, age) %>% 
  skim()

```

### 1B) Visualizations

```{r question_1b, echo=FALSE}

# This r chunk creates two plots

# The first plot shows the distribution of age in congress by chamber. I thought
# about showing age by party, but I found this data to be more interesting
# (there was some variation in age by party, but not enough to be very
# compelling to me). Party was also harder to map neatly in one plot; the bars
# got too skinny if I used position_dodge and it wasn't as readable if I used
# the default "stack" position. So I settled on this, which I think does a nice
# job preserving a clean look at the overall distribution of ages while adding
# the insight that there's more (relative) youth in the House

nominate_116 %>% 
  ggplot(aes(age, fill = chamber)) +
  geom_bar() +
  theme_classic() +
  labs(title = "Distribution of Congressional Ages by Chamber",
       subtitle = "More young Representatives than young Senators",
       x = "Age",
       y = "Count") +
  scale_fill_manual(name = "Chamber",
                    values = c("House" = "brown",
                               "Senate" = "black"))

# The second plot shows the relationship between age and ideology. I wasn't sure
# if I should make this plot, given that the prompt asked us to focus on one
# variable, but a histogram of percentile rank is essentially flat (given the
# nature of percentiles, they're spread out evenly, as seen in the skim()
# results) so that seemed really boring. So I thought, since we're supposed to
# be looking at the hypothesis that older senators are more conservative, I'd
# take a preliminary look at that in the context of the 116th congress. As I'd
# expected, party maps to ideology much more closely than age does. I initally
# thought (just eyeballing the scatterplot) that there was very little
# relationship between age and ideology, but adding geom_smooth() revealed the
# negative association, which (perhaps unsurprisingly) was more pronounced among
# Democrats than Republicans

nominate_116 %>% 
  ggplot(aes(age, nominate_percentile, color = party)) +
  geom_point() +
  theme_classic() +
  labs(title = "Congressional Age and Ideology with Simple Linear Regression",
       subtitle = "Some negative association between liberalism and age",
       x = "Age",
       y = "Percentile Rank (0 = most liberal)") +
  scale_color_manual(name = "Party",
                     breaks = c("Republican", "Democrat"),
                     values = c("Democrat" = "blue", "Republican" = "red")) +
  geom_smooth(method = "lm", se = FALSE)

```

### 1C) Bivariate Correlations

```{r question 1c, echo=FALSE}

# This r chunk finds the value of the correlation coefficient for age and
# nominate_percentile and assigns that value to an object to insert below. I
# round to 4 digits arbitrarily because 2 seemed too few, but 3 wasn't an
# option: because the value is 0.1596, it would just round to 0.16

cor_coeff <- nominate_116 %>% 
  summarize(cor = cor(age, nominate_percentile)) %>% 
  pull(cor) %>% 
  round(digits = 4)

```

The correlation coefficient for age and nominate_percentile for the 116th Congress is **`r cor_coeff`**.

The negative coefficient indicates that the variables are moving in *inverse* directions; as age goes up, the percentile rank of ideology goes down. If the coefficient were positive, age and percentile rank would move in the same direction.
